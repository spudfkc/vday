<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For Tati üíå</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&family=Caveat:wght@400;600;700&family=Lora:ital,wght@0,400;1,400&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --rose: #e8456b;
    --rose-deep: #c73558;
    --blush: #fce4ec;
    --cream: #fff8f0;
    --gold: #d4a056;
    --wine: #8b2252;
    --soft-pink: #f8bbd0;
    --envelope-front: #e8456b;
    --envelope-back: #c73558;
    --envelope-flap: #d43d60;
    --paper: #fffdf7;
  }

  body {
    font-family: 'Lora', serif;
    background: var(--cream);
    overflow: hidden;
    height: 100vh;
    width: 100vw;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  /* ============ FLOATING HEARTS BACKGROUND ============ */
  .hearts-bg {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
    overflow: hidden;
  }

  .floating-heart {
    position: absolute;
    font-size: 1.2rem;
    opacity: 0;
    animation: floatUp linear infinite;
    color: var(--soft-pink);
    filter: blur(0.5px);
  }

  @keyframes floatUp {
    0% { transform: translateY(100vh) rotate(0deg) scale(0.5); opacity: 0; }
    10% { opacity: 0.6; }
    90% { opacity: 0.3; }
    100% { transform: translateY(-10vh) rotate(360deg) scale(1.2); opacity: 0; }
  }

  /* ============ SCENE 1: ENVELOPE ============ */
  #scene-envelope {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: opacity 0.8s ease, transform 0.8s ease;
  }

  #scene-envelope.hidden {
    opacity: 0;
    transform: scale(1.1);
    pointer-events: none;
  }

  .envelope-label {
    font-family: 'Caveat', cursive;
    font-size: 1.8rem;
    color: var(--wine);
    margin-bottom: 30px;
    opacity: 0;
    animation: fadeSlideDown 1s ease 0.5s forwards;
    text-align: center;
    line-height: 1.4;
  }

  .envelope-label .name {
    display: block;
    font-size: 2.6rem;
    font-weight: 700;
    color: var(--rose);
    font-family: 'Playfair Display', serif;
    font-style: italic;
  }

  @keyframes fadeSlideDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Envelope container */
  .envelope-wrapper {
    perspective: 1000px;
    opacity: 0;
    animation: fadeSlideDown 1s ease 0.8s forwards;
  }

  .envelope {
    width: 320px;
    height: 220px;
    position: relative;
    cursor: pointer;
    transform-style: preserve-3d;
    transition: transform 0.3s ease;
  }

  .envelope:hover {
    transform: translateY(-4px);
  }

  /* Envelope body */
  .envelope-body {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, var(--envelope-front), var(--envelope-back));
    border-radius: 4px 4px 12px 12px;
    position: absolute;
    box-shadow: 0 8px 32px rgba(200, 53, 88, 0.3), 0 2px 8px rgba(0,0,0,0.1);
    overflow: hidden;
  }

  .envelope-body::after {
    content: '';
    position: absolute;
    inset: 8px;
    border: 1.5px solid rgba(255,255,255,0.2);
    border-radius: 2px 2px 10px 10px;
    pointer-events: none;
  }

  /* Envelope inner paper peek */
  .envelope-paper {
    position: absolute;
    width: 85%;
    height: 70%;
    background: var(--paper);
    top: 10%;
    left: 7.5%;
    border-radius: 4px;
    z-index: -1;
    box-shadow: inset 0 0 20px rgba(0,0,0,0.03);
    transition: transform 0.6s ease;
  }

  .envelope-paper::before {
    content: '';
    position: absolute;
    top: 20%;
    left: 15%;
    right: 15%;
    height: 2px;
    background: repeating-linear-gradient(
      to right,
      #e0d5c8 0, #e0d5c8 20px,
      transparent 20px, transparent 25px
    );
    opacity: 0.5;
  }

  /* Envelope flap */
  .envelope-flap {
    position: absolute;
    width: 100%;
    height: 55%;
    top: 0;
    left: 0;
    transform-origin: top center;
    transform-style: preserve-3d;
    z-index: 2;
    transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .envelope-flap-face {
    position: absolute;
    width: 0;
    height: 0;
    border-left: 160px solid transparent;
    border-right: 160px solid transparent;
  }

  .flap-front {
    border-top: 120px solid var(--envelope-flap);
    filter: brightness(1.05);
  }

  .flap-back {
    border-top: 120px solid var(--envelope-back);
    transform: rotateX(180deg);
    backface-visibility: hidden;
  }

  /* Seal */
  .seal {
    position: absolute;
    width: 52px;
    height: 52px;
    background: radial-gradient(circle, var(--gold) 0%, #c4903f 100%);
    border-radius: 50%;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -20%);
    z-index: 5;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    box-shadow: 0 2px 12px rgba(212, 160, 86, 0.5), inset 0 1px 2px rgba(255,255,255,0.4);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .envelope:hover .seal {
    box-shadow: 0 4px 20px rgba(212, 160, 86, 0.7), inset 0 1px 2px rgba(255,255,255,0.4);
  }

  .open-btn {
    display: block;
    margin-top: 28px;
    font-family: 'Caveat', cursive;
    font-size: 1.5rem;
    color: var(--rose);
    background: none;
    border: none;
    cursor: pointer;
    opacity: 0;
    animation: fadeSlideDown 1s ease 1.3s forwards;
    letter-spacing: 1px;
    position: relative;
    padding: 8px 24px;
    transition: color 0.3s ease;
  }

  .open-btn::after {
    content: '';
    position: absolute;
    bottom: 4px;
    left: 50%;
    width: 0;
    height: 1.5px;
    background: var(--rose);
    transition: width 0.3s ease, left 0.3s ease;
  }

  .open-btn:hover::after {
    width: 80%;
    left: 10%;
  }

  .open-btn:hover {
    color: var(--rose-deep);
  }

  /* Opening animation */
  .envelope.opening .envelope-flap {
    transform: rotateX(-180deg);
  }

  .envelope.opening .seal {
    transform: translate(-50%, -20%) scale(0);
    opacity: 0;
  }

  .envelope.opening .envelope-paper {
    transform: translateY(-80%);
  }

  /* ============ SCENE 2: VALENTINE QUESTION ============ */
  #scene-valentine {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 5;
    opacity: 0;
    pointer-events: none;
    transition: opacity 1s ease;
    padding: 20px;
  }

  #scene-valentine.visible {
    opacity: 1;
    pointer-events: auto;
  }

  .letter-card {
    background: var(--paper);
    border-radius: 16px;
    padding: 50px 44px;
    max-width: 520px;
    width: 100%;
    text-align: center;
    box-shadow: 0 20px 60px rgba(0,0,0,0.08), 0 1px 3px rgba(0,0,0,0.04);
    position: relative;
    overflow: visible;
    transform: translateY(30px);
    transition: transform 1s ease 0.2s;
  }

  #scene-valentine.visible .letter-card {
    transform: translateY(0);
  }

  .letter-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--rose), var(--gold), var(--rose));
  }

  .letter-card::after {
    content: '';
    position: absolute;
    inset: 12px;
    border: 1px solid rgba(232, 69, 107, 0.08);
    border-radius: 10px;
    pointer-events: none;
  }

  .letter-deco {
    font-size: 3rem;
    margin-bottom: 8px;
    display: block;
    animation: pulse 2s ease infinite;
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }

  .letter-greeting {
    font-family: 'Caveat', cursive;
    font-size: 1.6rem;
    color: var(--wine);
    margin-bottom: 6px;
  }

  .letter-question {
    font-family: 'Playfair Display', serif;
    font-size: 2.4rem;
    font-weight: 700;
    color: var(--rose-deep);
    line-height: 1.3;
    margin: 16px 0 8px;
  }

  .letter-name {
    font-family: 'Playfair Display', serif;
    font-style: italic;
    font-size: 2rem;
    color: var(--rose);
    margin-bottom: 32px;
  }

  .letter-subtitle {
    font-family: 'Caveat', cursive;
    font-size: 1.2rem;
    color: var(--gold);
    margin-bottom: 32px;
  }

  /* Buttons */
  .btn-row {
    display: flex;
    gap: 24px;
    justify-content: center;
    align-items: center;
    min-height: 120px;
    position: relative;
  }

  .btn-yes {
    font-family: 'Playfair Display', serif;
    font-size: 1.25rem;
    font-weight: 700;
    background: linear-gradient(135deg, var(--rose), var(--rose-deep));
    color: white;
    border: none;
    padding: 14px 48px;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(232, 69, 107, 0.35);
    transition: all 0.3s ease;
    letter-spacing: 0.5px;
    position: relative;
    z-index: 2;
  }

  .btn-yes:hover {
    transform: scale(1.08);
    box-shadow: 0 6px 30px rgba(232, 69, 107, 0.5);
  }

  .btn-no {
    font-family: 'Playfair Display', serif;
    font-size: 1rem;
    background: white;
    color: #999;
    border: 1.5px solid #ddd;
    padding: 12px 36px;
    border-radius: 50px;
    cursor: pointer;
    transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1), left 0.3s cubic-bezier(0.2, 0.8, 0.2, 1), top 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
    user-select: none;
    white-space: nowrap;
    position: relative;
    z-index: 1;
  }

  /* ============ SCENE 3: YES CELEBRATION ============ */
  #scene-celebration {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 20;
    opacity: 0;
    pointer-events: none;
    transition: opacity 1s ease;
    background: radial-gradient(ellipse at center, #fff5f7 0%, var(--cream) 100%);
  }

  #scene-celebration.visible {
    opacity: 1;
    pointer-events: auto;
  }

  .celebration-text {
    font-family: 'Playfair Display', serif;
    font-size: 3rem;
    font-weight: 700;
    color: var(--rose-deep);
    text-align: center;
    opacity: 0;
    transform: scale(0.5);
    animation: celebReveal 1s cubic-bezier(0.34, 1.56, 0.64, 1) 0.3s forwards;
    line-height: 1.3;
  }

  .celebration-sub {
    font-family: 'Caveat', cursive;
    font-size: 1.8rem;
    color: var(--wine);
    margin-top: 12px;
    opacity: 0;
    animation: fadeSlideDown 1s ease 1s forwards;
  }

  .celebration-hearts {
    font-size: 4rem;
    margin-bottom: 16px;
    opacity: 0;
    animation: celebReveal 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s forwards;
  }

  @keyframes celebReveal {
    from { opacity: 0; transform: scale(0.5); }
    to { opacity: 1; transform: scale(1); }
  }

  /* Confetti */
  .confetti-container {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 30;
    overflow: hidden;
  }

  .confetti {
    position: absolute;
    width: 10px;
    height: 10px;
    top: -10px;
    animation: confettiFall linear forwards;
  }

  @keyframes confettiFall {
    0% { transform: translateY(0) rotateZ(0deg) rotateX(0deg); opacity: 1; }
    100% { transform: translateY(110vh) rotateZ(720deg) rotateX(360deg); opacity: 0.5; }
  }

  /* ============ SPARKLE BURST ============ */
  .sparkle-burst {
    position: fixed;
    pointer-events: none;
    z-index: 25;
  }

  .sparkle {
    position: absolute;
    width: 6px;
    height: 6px;
    background: var(--gold);
    border-radius: 50%;
    animation: sparklePop 0.6s ease forwards;
  }

  @keyframes sparklePop {
    0% { transform: translate(0,0) scale(1); opacity: 1; }
    100% { transform: translate(var(--dx), var(--dy)) scale(0); opacity: 0; }
  }

  /* ============ RESPONSIVE ============ */
  @media (max-width: 500px) {
    .envelope { width: 260px; height: 180px; }
    .envelope-flap-face {
      border-left-width: 130px;
      border-right-width: 130px;
    }
    .flap-front, .flap-back { border-top-width: 100px; }
    .letter-card { padding: 36px 28px; }
    .letter-question { font-size: 1.8rem; }
    .letter-name { font-size: 1.5rem; }
    .celebration-text { font-size: 2.2rem; }
    .envelope-label .name { font-size: 2rem; }
  }
</style>
</head>
<body>

<!-- Floating hearts background -->
<div class="hearts-bg" id="heartsBg"></div>

<!-- SCENE 1: Envelope -->
<div id="scene-envelope">
  <div class="envelope-label">
    A little something for
    <span class="name">Tati</span>
  </div>
  <div class="envelope-wrapper">
    <div class="envelope" id="envelope" onclick="openEnvelope()">
      <div class="envelope-paper"></div>
      <div class="envelope-body"></div>
      <div class="envelope-flap">
        <div class="envelope-flap-face flap-front"></div>
        <div class="envelope-flap-face flap-back"></div>
      </div>
      <div class="seal">üíå</div>
    </div>
  </div>
  <button class="open-btn" onclick="openEnvelope()">tap to open</button>
</div>

<!-- SCENE 2: Valentine Question -->
<div id="scene-valentine">
  <div class="letter-card">
    <span class="letter-deco">üíï</span>
    <div class="letter-greeting">Dear Tati,</div>
    <div class="letter-question">Will you be my<br>Valentine?</div>
    <div class="letter-name">‚Äî yours truly üåπ</div>
    <div class="letter-subtitle">( pick wisely... or try to üòè )</div>
    <div class="btn-row" id="btnRow">
      <button class="btn-yes" onclick="sayYes()">Yes! üíñ</button>
      <button class="btn-no" id="btnNo">No</button>
    </div>
  </div>
</div>

<!-- SCENE 3: Celebration -->
<div id="scene-celebration">
  <div class="celebration-hearts">üíñü•∞üíñ</div>
  <div class="celebration-text">Yaaay!! üéâ<br>I knew you'd say yes!</div>
  <div class="celebration-sub">Happy Valentine's Day, Tati üíï</div>
</div>

<div class="confetti-container" id="confettiContainer"></div>

<script>
  // ============ FLOATING HEARTS ============
  const heartsBg = document.getElementById('heartsBg');
  const heartChars = ['‚ô•', '‚ô°', '‚ù§', 'üíï', '‚úø', '‚ùÄ'];
  for (let i = 0; i < 25; i++) {
    const h = document.createElement('span');
    h.className = 'floating-heart';
    h.textContent = heartChars[Math.floor(Math.random() * heartChars.length)];
    h.style.left = Math.random() * 100 + '%';
    h.style.fontSize = (0.8 + Math.random() * 1.4) + 'rem';
    h.style.animationDuration = (6 + Math.random() * 8) + 's';
    h.style.animationDelay = (Math.random() * 10) + 's';
    heartsBg.appendChild(h);
  }

  // ============ OPEN ENVELOPE ============
  let envelopeOpened = false;
  function openEnvelope() {
    if (envelopeOpened) return;
    envelopeOpened = true;

    const env = document.getElementById('envelope');
    env.classList.add('opening');

    // Sparkle burst on seal
    createSparkleBurst(env.querySelector('.seal'));

    setTimeout(() => {
      document.getElementById('scene-envelope').classList.add('hidden');
    }, 900);

    setTimeout(() => {
      document.getElementById('scene-valentine').classList.add('visible');
    }, 1300);
  }

  function createSparkleBurst(el) {
    const rect = el.getBoundingClientRect();
    const cx = rect.left + rect.width / 2;
    const cy = rect.top + rect.height / 2;
    const burst = document.createElement('div');
    burst.className = 'sparkle-burst';
    burst.style.left = cx + 'px';
    burst.style.top = cy + 'px';
    for (let i = 0; i < 12; i++) {
      const s = document.createElement('div');
      s.className = 'sparkle';
      const angle = (Math.PI * 2 * i) / 12;
      const dist = 30 + Math.random() * 40;
      s.style.setProperty('--dx', Math.cos(angle) * dist + 'px');
      s.style.setProperty('--dy', Math.sin(angle) * dist + 'px');
      s.style.background = ['#d4a056','#e8456b','#f8bbd0','#fff'][Math.floor(Math.random()*4)];
      burst.appendChild(s);
    }
    document.body.appendChild(burst);
    setTimeout(() => burst.remove(), 700);
  }

  // ============ RUNAWAY NO BUTTON ============
  const btnNo = document.getElementById('btnNo');
  let noAttempts = 0;
  const funnyTexts = ['No', 'Really?', 'Think again!', 'Nope!', 'Nice try üòÇ', "Can't catch me!", 'Hehe üòú', 'Not happening!', 'Try harder!', 'üí®'];
  
  let offsetX = 0;
  let offsetY = 0;

  function escapeNo(e) {
    noAttempts++;
    btnNo.textContent = funnyTexts[Math.min(noAttempts, funnyTexts.length - 1)];

    // Get button center
    const rect = btnNo.getBoundingClientRect();
    const btnCX = rect.left + rect.width / 2;
    const btnCY = rect.top + rect.height / 2;

    // Get cursor/touch position
    let cursorX, cursorY;
    if (e.type === 'touchstart' || e.type === 'touchmove') {
      cursorX = e.touches[0].clientX;
      cursorY = e.touches[0].clientY;
    } else {
      cursorX = e.clientX || btnCX;
      cursorY = e.clientY || btnCY;
    }

    // Calculate flee direction (away from cursor)
    let dx = btnCX - cursorX;
    let dy = btnCY - cursorY;
    const dist = Math.sqrt(dx * dx + dy * dy) || 1;
    dx /= dist;
    dy /= dist;

    // Flee distance ‚Äî randomized a bit for playfulness
    const fleeDist = 120 + Math.random() * 80;
    let newOffsetX = offsetX + dx * fleeDist;
    let newOffsetY = offsetY + dy * fleeDist;

    // Clamp within viewport with padding
    const pad = 20;
    const baseRect = btnNo.getBoundingClientRect();
    // Calculate where the button would end up
    const projectedLeft = baseRect.left + (newOffsetX - offsetX);
    const projectedTop = baseRect.top + (newOffsetY - offsetY);
    const projectedRight = projectedLeft + rect.width;
    const projectedBottom = projectedTop + rect.height;

    if (projectedLeft < pad) newOffsetX += (pad - projectedLeft);
    if (projectedTop < pad) newOffsetY += (pad - projectedTop);
    if (projectedRight > window.innerWidth - pad) newOffsetX -= (projectedRight - window.innerWidth + pad);
    if (projectedBottom > window.innerHeight - pad) newOffsetY -= (projectedBottom - window.innerHeight + pad);

    // If it would bounce back toward cursor, add perpendicular dodge
    const newDx = newOffsetX - offsetX;
    const newDy = newOffsetY - offsetY;
    const dotProduct = newDx * dx + newDy * dy;
    if (dotProduct < 20) {
      // Dodge perpendicular instead
      const perpX = -dy;
      const perpY = dx;
      const perpDir = Math.random() > 0.5 ? 1 : -1;
      newOffsetX = offsetX + perpX * fleeDist * perpDir;
      newOffsetY = offsetY + perpY * fleeDist * perpDir;
    }

    offsetX = newOffsetX;
    offsetY = newOffsetY;

    // Add a little wobble rotation
    const rotation = (Math.random() - 0.5) * 20;

    btnNo.style.transform = `translate(${offsetX}px, ${offsetY}px) rotate(${rotation}deg)`;

    // Make yes button bigger with each attempt
    const yesBtn = document.querySelector('.btn-yes');
    const scale = 1 + noAttempts * 0.04;
    yesBtn.style.transform = `scale(${Math.min(scale, 1.4)})`;
  }

  btnNo.addEventListener('mouseenter', escapeNo);
  btnNo.addEventListener('touchstart', (e) => { e.preventDefault(); escapeNo(e); });
  btnNo.addEventListener('click', (e) => { e.preventDefault(); escapeNo(e); });

  // ============ YES CELEBRATION ============
  function sayYes() {
    document.getElementById('scene-valentine').style.opacity = '0';
    document.getElementById('scene-valentine').style.pointerEvents = 'none';

    setTimeout(() => {
      document.getElementById('scene-celebration').classList.add('visible');
      launchConfetti();
    }, 600);
  }

  function launchConfetti() {
    const container = document.getElementById('confettiContainer');
    const colors = ['#e8456b', '#f8bbd0', '#d4a056', '#fff', '#c73558', '#ff6b8a', '#fce4ec', '#8b2252'];
    const shapes = ['circle', 'square', 'heart'];
    
    for (let wave = 0; wave < 3; wave++) {
      setTimeout(() => {
        for (let i = 0; i < 50; i++) {
          const c = document.createElement('div');
          c.className = 'confetti';
          const color = colors[Math.floor(Math.random() * colors.length)];
          const shape = shapes[Math.floor(Math.random() * shapes.length)];
          
          if (shape === 'heart') {
            c.textContent = '‚ô•';
            c.style.fontSize = (8 + Math.random() * 14) + 'px';
            c.style.color = color;
            c.style.background = 'none';
            c.style.width = 'auto';
            c.style.height = 'auto';
          } else {
            c.style.background = color;
            c.style.borderRadius = shape === 'circle' ? '50%' : '2px';
            c.style.width = (6 + Math.random() * 10) + 'px';
            c.style.height = (6 + Math.random() * 10) + 'px';
          }

          c.style.left = Math.random() * 100 + '%';
          c.style.animationDuration = (2 + Math.random() * 3) + 's';
          c.style.animationDelay = (Math.random() * 0.5) + 's';
          container.appendChild(c);
        }
      }, wave * 600);
    }

    setTimeout(() => container.innerHTML = '', 8000);
  }
</script>
</body>
</html>